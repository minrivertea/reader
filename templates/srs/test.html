<script type="text/javascript">

    function bindTestButtons() {
        
        /// UNBIND EVERYTHING FOR SAFETY
        $('.test_item button').unbind();
        
        /// REBIND SPECIFIC LINKS
        $('.test_item button').not('.skip').bind('click', clickAnswer);
        $('.test_item button.skip').bind('click', clickSkip);
    };
    
    
    function removeTestItem(item) {
        item.delay(1500).fadeOut(300, function() {
            item.remove(); 
        });
    }
    
    function sendTestResults(params) {
        /// sends test results to server via AJAX
        $.ajax({
            url: "{% url 'submit_answer' %}",
            type: 'POST',
            data: params,
            success: function() {
                /// do nothing...
            }, 
        });  
    }

    function clickAnswer() {
    
        removeTestItem($(this).parents('.test_item'));
        
        $(this).removeClass('empty');
        
        $(this).parents('.test_item').find('button').attr('disabled', '');
        
        var statusBar = $(this).parents('.test_item').find('.statusbar')

        if ( $(this).attr('data-correct') == 'true' ) {
            statusBar.html('Nice work, you got it right!');
            var params = {
                    'testing': $(this).attr('data-testing'), 
                    'chars': $(this).attr('data-chars'),
                    'correct': 'true',
            };
            sendTestResults(params);
        } else {
            statusBar.html("Sorry, that's not the right answer");
        }
            
    };
       
    function clickSkip() {
        removeTestItem($(this).parents('.test_item')); 
    };
   

    $(document).ready( function() {
        bindTestButtons(); 
    });
    
</script>



  {% if items %}
  
        <div class="test_item pure-u-1 l-pad r-pad text-center">
            You've finished your test items for today. Pat yourself on the back!
        </div>
    {% for x in items %}
        <div class="test_item pure-u-1 l-pad r-pad">{{ x|safe }}</div>
        
    {% endfor %}
    
    
  {% else %}
    <p class="pure-u-1 text-center l-pad r-pad">You've got no items to test right now</p>
  {% endif %}
    
    

    
    
